!function(t,o){var n=o.Model.extend({initialize:function(t,o){o||(o={}),this.options=_.defaults(o,this.defaultOptions),_.bindAll(this,"onLoginStatusChange"),FB.Event.subscribe("auth.authResponseChange",this.onLoginStatusChange)},options:null,defaultOptions:{scope:[],autoFetch:!0,protocol:location.protocol},_loginStatus:null,isConnected:function(){return"connected"===this._loginStatus},login:function(t){"undefined"==typeof t&&(t=function(){}),FB.login(t,{scope:this.options.scope.join(",")})},logout:function(){FB.logout()},updateLoginStatus:function(){FB.getLoginStatus(this.onLoginStatusChange)},onLoginStatusChange:function(t){if(this._loginStatus===t.status)return!1;var o;"not_authorized"===t.status?o="facebook:unauthorized":"connected"===t.status?(o="facebook:connected",this.options.autoFetch===!0&&this.fetch()):o="facebook:disconnected",this._loginStatus=t.status,this.trigger(o,this,t)},parse:function(t){var o=_.extend(t,{pictures:this.profilePictureUrls(t.id)});return o},sync:function(t,o,n){if("read"!==t)throw new Error("FacebookUser is a readonly model, cannot perform "+t);var e=function(t){return t.error?n.error(t):n.success(t),!0},i=FB.api("/me",e);return o.trigger("request",o,i,n),i},profilePictureUrls:function(t){t||(t=this.id);var o={};return _(["square","small","normal","large"]).each(function(n){o[n]=this.profilePictureUrl(t,n)},this),o},profilePictureUrl:function(t,o){return[this.options.protocol,"//graph.facebook.com/",t,"/picture?type=",o,this.options.protocol.indexOf("https")>-1?"&return_ssl_resources=1":""].join("")}});return t.FacebookUser=n,n}(this,Backbone);
